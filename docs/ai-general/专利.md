
# 1、相关技术背景（背景技术），与本发明最相近似的现有实现方案（现有技术）
## 1．1 背景技术

现有技术中，目前已经出现了一些有关预训练语言模型的量化方法，包括8比特定精度量化，基于海森矩阵的混精度量化

8比特定精度量化：将模型所有需要量化的层都量化到8比特，之后再微调。

基于海森矩阵的混精度量化：利用每层参数的海森矩阵的信息决定该层的量化精度。海森矩阵越大特征值越大的层量化精度越高，反之越低。量化之后再进行微调。

上面两个方法中最底层的量化方案都是线性量化。也就是说，每一个要单独量化的张量都采用了线性量化：首先找到该张量里参数的最大值和最小值，然后将这个范围平均划分成若干份，如果量化成n比特，则要分成2n份，也就是2n类。将属于每类的所有参数的平均值作为该类的中心值，每个参数就被它所属类的中心值代替。这样这个张量就被一个储存每类中心值的张量和一个储存每个参数所属类的张量代替。

发明人在实现本申请的过程中发现，现有方案至少存在以下缺陷：

线性量化的压缩效果不是很好：量化模型在低精度时的表现下降较多，这使得模型不能压缩到很低精度

线性量化并不是一种很好的聚类方法。被量化的向量并不能很好的表示原来向量的参数分布。


## 1．	2 与本发明相关的现有技术（可以写多个现有技术）
（用文字对现有技术进行简单介绍。如果该现有技术在公开出版物上有记载，最好提供出处。现有技术有相关附图的，最好一并提供）
### 1．2．1 现有技术的技术方案
### 1．2．2 现有技术的缺点
（客观评价现有技术存在的缺点。所指出的缺点应是本发明创造能够解决的）
# 2、本发明技术方案的详细阐述（发明内容）

本发明实施例提供一种预训练语言模型量化方法及装置，用于至少解决上述技术问题之一。

第一方面，本发明实施例提供一种预训练语言模型量化方法，包括：将预训练语言模型在下游任务上进行第一次微调；使用k均值聚类，对微调后的模型除了分类层之外的其他所有嵌入层和所有线性层的权重矩阵中的数据进行聚类，将类别数设置为2n，其中，n为压缩后目标模型每个数据所占的比特数；以及将量化后的模型在所述下游任务上在维持量化的条件下进行第二次微调，最终得到量化后的网络。

第二方面，本发明实施例提供一种预训练语言模型量化装置，包括：第一次微调模块，配置为将预训练语言模型在下游任务上进行第一次微调；聚类压缩模块，配置为使用k均值聚类，对微调后的模型除了分类层之外的其他所有嵌入层和所有线性层的权重矩阵中的数据进行聚类，将类别数设置为2n，其中，n为压缩后目标模型每个数据所占的比特数；以及第二次微调模块，配置为将量化后的模型在所述下游任务上在维持量化的条件下进行第二次微调，最终得到量化后的网络。

第三方面，提供一种电子设备，其包括：至少一个处理器，以及与所述至少一个处理器通信连接的存储器，其中，所述存储器存储有可被所述至少一个处理器执行的指令，所述指令被所述至少一个处理器执行，以使所述至少一个处理器能够执行本发明任一实施例的预训练语言模型量化方法的步骤。


第四方面，本发明实施例还提供一种计算机程序产品，所述计算机程序产品包括存储在非易失性计算机可读存储介质上的计算机程序，所述计算机程序包括程序指令，当所述程序指令被计算机执行时，使所述计算机执行本发明任一实施例的预训练语言模型量化方法的步骤。

本申请的方法和装置提供的方案表明了底层的量化方案的提升对量化效果的影响被大大的低估和忽视了；同时也表明了简单的不使用任何技巧的k均值量化就可以达到非常好的压缩效果，说明k均值压缩方法有非常大的发展空间和应用前景。

## 2．1 本发明所要解决的技术问题
（即发明目的）
## 2．2 本发明提供的完整技术方案
（即发明方案，为了更好地解释发明创造，应当提供附图（流程图、模块结构框图）（不适于提供附图的除外），附图中有关结构要给出标号，并结合附图进行详细说明，包括本方案的具体工作过程及原理）
## 2．3 本发明技术方案带来的有益效果
（结合发明方案中指出的技术要点，说明本发明创造带来的有益效果，并提供反映有益效果的数据资料，可列出表格与现有技术从各个方面进行逐一对比，还可阐述本方案在某个具体实施环境下产生了或将会产生怎么样的有益效果，例如，某个方案如果有1000人使用可提高多少效益或节约多数据量，等等）

# 3、针对2中的技术方案，是否还有别的替代方案同样能完成发明目的
（此部分应尽可能多地提出本发明创造的变通结构和方案。对于与产品结构有关的发明创造应提供附图，并结合附图对其中重要的变通方案应提供附图，并通过文字进一步解释）

# 4、本发明的技术关键点和欲保护点是什么
（明确发明创造的技术要点及其重要性）

# 5、本发明是否经过实验、模拟、使用而证明可行，结果如何？（简单介绍）


# 6、其他有助于专利代理人理解本技术的资料，如实例说明

# 7、本发明的难点体现在哪？
